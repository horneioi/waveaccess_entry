```markdown
# Задания для стажировки DevOps

## Bash скрипт

Написать скрипт, который:

- Скачает произведение «Война и мир» в текстовом виде из https://avidreaders.ru/download/voyna-i-mir-tom-1.html?f=txt | TODO: парс сайта для поиска ссылки на файл в обход ожидания JS.
- Распакует
- Выведет на экран 5 самых популярных русскоязычных слов длинной больше 5 символов (всё привести к нижнему регистру)
- Если слово «князь» присутствует в списке:
  - Сделать запрос `curl` к ya.ru и вывести в формате JSON всю статистику curl по этому запросу (`-w`)
- Если слова «говорил» нет в списке:
  - Сделать такой же запрос, но к google.coom (не опечатка)
- Сделать запрос к сайту, переданному в качестве первого аргумента (вывести весь JSON)
- В качестве второго аргумента передать URL файла, который нужно скачать в подпапку `download` (создать, если её нет, в логах об этом упомянуть)
- Вывести статистику скачанного файла: владелец, группа, права, размер, относительный путь, полный путь
- Вести лог успешного и неуспешного выполнения команд (создаются рядом со скриптом)
- Если пользователь не передал аргументы — ошибка, выводится на экран и в лог файл

---

## Контейнеры

- Настроить hosts (Windows/Linux) с внутренним доменом `.devops`
- Создать приватный ключ и публичный сертификат для зоны `.devops`
- Использовать ключ и сертификат для HTTPS между контейнерами (добавить в доверенные)
- Выдать домены для nginx и drupal

Требуется связать три контейнера:

- **nginx** как реверс-прокси для Drupal:
  - `/` → `/opt/html/root/`:
    - `static.html` содержит самое популярное слово + частота и вывод `/etc/os-release`
    - `index.html` выводит все переменные окружения
  - `/dp/` → реверс-прокси к Drupal, доступ через basic auth (пользователь при сборке, пароль переменная окружения)
  - `/upload/` → `/opt/html/upload/` для постоянного хранения
- **Drupal**
- **MariaDB/MySQL** для Drupal

---

## CI/CD

- Docker registry с web basic auth и доменом
- Домен для Jenkins

Pipeline:
1. Запуск Bash скрипта для скачивания «Войны и мира»
2. Сборка образа nginx reverse-proxy для Drupal
3. Деплой трёх образов (nginx, mariadb, drupal) через docker-compose
4. Тестирование:
   - Скрипт закидывает файл в `/opt/html/upload/` и скачивает через фронт
   - Curl к любому API Drupal

---

## Ansible

Написать плейбуки/роли:

1. Добавление пользователя с группами, ssh ключом; поддержка удаления с настройками и файлами
2. Установка docker и docker-compose (можно указать версию); поддержка удаления с очисткой всех сущностей
3. Создание docker-compose файла для Drupal и БД, запуск контейнеров, возможность менять версии образов и переменные окружения; поддержка удаления с очисткой образов и томов

Дополнительно:
- В ролях указать поддерживаемые ОС и версии, автора
- Оптимизировать работу для скорости
- Плейбуки/роли должны храниться в git и запускаться из пайплайна с параметризацией
```